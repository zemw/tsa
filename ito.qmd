# A Crash Course on Brownian Motion

## Brownian Motion

**Brownian motion**, or **Wiener process**, is the continuous-time
extension of a discrete-time random walk. To define the continuous
version of a random walk, we cannot simply sum up infinite number of
white noises, which will certainly explode. Instead, we chop up a finite
interval into infinitely many small intervals, each one corresponding to
a tiny white noise. The following table shows how a discrete random walk
extends to a continuous function.

<!-- WARNING: switch to visual model breaks the table -->

|                     | Random Walk                                 | Brownian Motion                                                 |
|---------------------|---------------------------------------------|-----------------------------------------------------------------|
| Innovation          | $\epsilon_i\sim\text{WN}(0,1)$              | ![](fig/epsilon.png){width="200px"}                             |
| Stochastic process  | $y_t = \epsilon_1 + \cdots + \epsilon_t$    | $W(t)_{t\in[0,1]} = \lim_{n\to\infty}\sum_{i=1}^{nt}\epsilon_i$ |
| Expectation         | $\mathbb E[y_t]=0$                          | $\mathbb E[W(t)] = 0$                                           |
| Variance            | $\text{Var}[y_t]=t\text{Var}[\epsilon_i]=t$ | $\text{Var}[W(t)]=nt\text{Var}[\epsilon_i]=t$                   |
| Quadratic variation | $\mathbb E\sum_{i=1}^{t}(y_i-y_{i-1})^2=t$  | $\int_0^t(dW)^2 = t$                                            |

: Random Walk and Brownian Motion

Brownian motion $W(t)$ is a stochastic function. Its realized path is
different each time we take a draw from it. But every piece of it
follows a tiny Gaussian process. **The function is continuous, but
nowhere differentiable.** It is hard to imagine such a function at first
glance. But as we proceed, we will appreciate its amazing properties.
Despite its path is random, the area under the curve integrates to a
well-defined probability distribution. The squared changes (quadratic
variation) even sum up to a deterministic constant.

```{r}
#| echo: false
#| fig-cap: "Simulation of Brownian Motion"
#| label: fig-simbm
brownian = function(r, n=1000) {
  cumsum(rnorm(n*r,0,1/n))
}
plot(brownian(1), type="l")
```

## Basic Properties

The **quadratic variation** is one the most important properties of
Brownian motion. Intuitively, it says the squared tiny changes sum up to
a constant with probability 1 no matter which realized path it takes.
Smooth functions will not have such property, because $(dX)^2$
diminishes much faster than $dX$, surely we get $\int_0^t(dX)^2 =0$.
Because Brownian motion fluctuations too much, the squared changes do
not diminish away. To see this, imagine summing up the squares of
infinitely many small increments up to $t$:

$$
\lim_{n\to\infty}\sum_{i=1}^{nt}\left[X\left(\frac{i}{n}\right)-X\left(\frac{i-1}{n}\right)\right]^2 = \lim_{n\to\infty}\sum_{i=1}^{nt}\epsilon_i^2,
$$

with $\epsilon_i\sim N\left(0,\frac{1}{n}\right)$. Therefore,
$\mathbb E(\epsilon_i^2)=\frac{1}{n}$. Let $z_i = \epsilon_i^2$. The sum
above can be rewritten as

$$
\sum_{i=1}^{nt} z_i = nt\left(\frac{1}{nt}\sum_{i=1}^{nt} z_i\right) \overset{\text{LLN}}\to nt\mathbb{E}(z_i)=t.
$$

The integral version is the quadratic variation

$$
\int_0^t(dW)^2 = t,
$$ {#eq-quad2}

or written in differential form

$$
(dW)^2 = dt.
$$ {#eq-quad}

Now we drive some basic properties of Brownian motions. Note that by
Central Limit Theorem,

$$
\frac{1}{\sqrt{nt}} W(t) = \sqrt{nt}\frac{1}{nt}\sum_{i=1}^{nt}\epsilon_i\to N\left(0,\frac{1}{n}\right)
$$

Therefore,

$$
W(t) \sim \sqrt{nt} N\left(0,\frac{1}{n}\right) \sim N(0,t)
$$ {#eq-brnorm}

It follows that, for any $r<s$,

$$
W(s) - W(t) \sim N(0, s-t)
$$ {#eq-brdiff}

As $s$ and $t$ become arbitrarily close, we have

$$
dW \sim N(0, dt)
$$ {#eq-brdr}

## It么 Calculus

::: {#thm-ito1}
Let $F(W)$ be a "smooth" function of a Brownian motion $W(t)$. Then

$$
dF = F'dW + \frac{1}{2}F''dt.
$$
:::

::: proof
It immediately follows from the Taylor expansion

$$
F(W_{t+h})-F(W_t)=F'(W_{t+h}-W_t)+\frac{1}{2}F''(W_{t+h}-W_t)^2+\cdots
$$

As $h\to 0$,

$$
dF = F'dW + \frac{1}{2}F''(dW)^2.
$$

By @eq-quad, $(dW)^2= dt$. Therefore,

$$
dF = F'dW + \frac{1}{2}F''dt.
$$
:::

Note that how this differs from the differential formula for normal
functions: $dF = F'dW$. The second-order term does not disappear
precisely because the quadratic variation does not go to zero.

::: {#exm-1}
$F(W) = W^2 \implies dF = 2WdW + dt$
:::

An extension of @thm-ito1 include an additional variable $t$. It follows
immediately from the the partial differentiation rule and the result
above.

::: {#thm-ito2}
Let $F(t, W)$ be a function of real-valued $t$ and Brownian motion
$W(t)$. Then

$$
dF = (F_t + F_{ww}) dt + F_w dW.
$$
:::

::: {#exm-2}
$F(t, W)=tW \implies d(tW) = W dt + t dW$
:::

The reverse operation of stochastic differentiation is stochastic
integral.

::: {#thm-itoint}
1.  $\int_{0}^{t} dW = W(t)$;
2.  $F(W_t)=\int_0^t f(W_s)dW_s$ , if $\mathrm{d}F = f\mathrm{d}W$;
3.  $F(t, W_t) = \int_0^t f(s, W_s)dW_s + \int_0^t g(s, W_s)dt$ , if
    $\mathrm{d}F = f\mathrm{d}W + g\mathrm{d}t$.
:::

::: {#exm-3}
Given $dW^2 = 2W dW + dt$, take integral on both sides:

$$
W^2(t) = 2\int_0^t W_s dW_s + \int_0^t ds
$$

$$
\implies \int_0^t W_s dW_s = \frac{1}{2}[W^2(t) - t].
$$

Setting $t=1$, it follows that

$$
\int_0^1 W dW = \frac{1}{2}[W^2(1)-1].
$$

Note that $W(1) \sim N(0,1)$. So $W^2(1) \sim \chi^2(1)$ with
expectation 1. Thus $\int_0^1 W dW$ is centered at 0 but skewed.
:::

::: {#exm-4}
Given $d(tW) = Wdt + t\ dW$, we have

$$
tW(t) = \int_0^t W(s)ds + \int_0^t s\ dW
$$

$$
\begin{aligned}
\implies \int_0^t W(s)ds &= tW(t) - \int_0^t s\ dW \\
&=t\int_0^t dW - \int_0^t s\ dW \\
&=\int_0^t (t-s) dW.
\end{aligned}
$$
:::

::: callout-note
## Making Sense of It么 Calculus

Let $F(t)$ be a continuous-time trading strategy that holds an amount of
$F(t)$ of a stock at time $t$. The stock price is a Brownian motion
$W(t)$. $dW$ represents the movement of stock price. Consider the It么's
integral

$$
Y_t = \int_0^t F dW
$$

The stochastic integral represents the payoff of the trading strategy up
to time $t$. Note that the integral always evaluates *at the left*. So
the strategy can only make decision based on available information.
:::

::: {#thm-isometry}
Let $W(t)$ be a Brownian motion. Let $f(t)$ be a nonrandom function of
time. Then the following holds

1.  $\mathbb{E}\left[\int_0^t f(s)dW\right]=0$;
2.  $\mathbb{E}\left[\left(\int_0^t f(s)dW\right)^2\right]=\mathbb{E}\left[\int_0^t f^2 ds\right]$
    (It么 isometry);
3.  $\int_0^t f(s) dW \sim N\left(0, \int_0^t f^2 ds\right)$.
:::

If $f(t)$ represents a trading strategy and the stock price follows a
Brownian motion, the theorem tells us the expected payoff of this
strategy is zero; more precisely, the payoff follows a Gaussian
distribution.

::: {#exm-5}
Following the last example,

$$
\int_0^t W ds = \int_0^t (t-s) dW
$$

$f(s) = t-s$ is a nonrandom function, apply the theorem above

$$
\text{var}\left[\int_0^t W ds\right]=\int_0^t (t-s)^2ds = \frac{1}{3}t^3
$$

Therefore,

$$
\int_0^t W(s) ds \sim N\left(0, \frac{1}{3}t^3\right).
$$

Thus, the integral, the area under the curve of a Brownian motion,
follows a Gaussian distribution.
:::

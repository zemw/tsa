# Unit Roots in VAR

So far we have only considered stationary VARs. Now we discuss what happens
if a VAR contains unit roots. Recall that a VAR($p$) process

$$
y_t = \Phi_1y_{t-1} + \Phi_2y_{t-2} + \dots + \Phi_py_{t-p} + \epsilon_t
$$

contains at least one unit root iff

$$
|I_n - \Phi_1 - \Phi_2 -\dots-\Phi_p|=0.
$$

Rewrite the formulation as follows:

$$
\begin{array}{rrrrr}
& y_t = &\Phi_1y_{t-1} + \dots + &\Phi_{p-2}y_{t-p+2} + &\Phi_{p-1}y_{t-p+1} + &\Phi_{p}y_{t-p} \\ 
& =&\Phi_1y_{t-1} + \dots + &\Phi_{p-2}y_{t-p+2} - &(\Phi_{p-1}+\Phi_p)y_{t-p+1} - &\Phi_{p}\Delta y_{t-p+1} \\ 
& =&\Phi_1y_{t-1} + \dots - &(\Phi_{p-2}+\Phi_{p-1}+\Phi_p)y_{t-p+2} - &(\Phi_{p-1}+\Phi_p)\Delta y_{t-p+2} - &\Phi_{p}\Delta y_{t-p+1} \\ 
& \vdots \\
\end{array}
$$

Therefore,

$$
y_t = \rho y_{t-1} + \zeta_1\Delta y_{t-1} + \cdots + \zeta_{p-2}\Delta y_{t-p+2} + \zeta_{p-1}\Delta y_{t-p+1} + \epsilon_t

$$

where

$$
\begin{array}{rrrrr}
&\rho = &\Phi_1 + &\Phi_2 + &\dots + &\Phi_{p-1} + &\Phi_p \\
&-\zeta_1 = & &\Phi_2 + &\dots + &\Phi_{p-1} + &\Phi_p \\
&\vdots  \\
&-\zeta_{p-2} = & & & &\Phi_{p-1} + &\Phi_p \\
&-\zeta_{p-1} = & & & & &\Phi_p \\
\end{array}
$$

Thus, $\Phi_1=\rho+\zeta_1$, $\Phi_s=\zeta_s-\zeta_{s-1}$, $\Phi_p=-\zeta_{p-1}$.
So all coefficients of the original VAR $\{\Phi_s\}$ are linearly combinations
involving coefficients of stationary regressors. 

```{r}
#| echo: true
#| message: false
#| warning: false
library(tsDyn)
library(vars)
set.seed(0)
bhat = sapply(1:1000, function(i) {
  B = matrix(c(0.7, 0.1, 0.3, 0.9), 2)
  sim <- VAR.sim(B, n = 300, include = "none")
  mod = VAR(sim); b = coef(mod)
  c(B11 = b$y1['y1.l1', 'Estimate'],
    B12 = b$y1['y2.l1', 'Estimate'],
    B21 = b$y2['y1.l1', 'Estimate'],
    B22 = b$y2['y2.l1', 'Estimate'])
}) |> t()
{
  par(mfrow=c(2,2), mar=c(2,2,2,2))
  hist(bhat[,'B11'], freq=F, main="B11")
  hist(bhat[,'B12'], freq=F, main="B12")
  hist(bhat[,'B21'], freq=F, main="B21")
  hist(bhat[,'B22'], freq=F, main="B22")
}
```

